function changeLevel(n){gameModel.currentLevel=parseInt(n);ShootrUI.renderLevelSelect();var t=Math.pow(1.2,gameModel.currentLevel-1);Bullets.enemyBullets.enemyShotStrength=gameModel.currentLevel*t;Bullets.enemyBullets.enemyShotSpeed=100+gameModel.currentLevel*2;EnemyShips.waveBulletFrequency=3e3-gameModel.currentLevel;EnemyShips.shipHealth=2*gameModel.currentLevel*t;enemiesKilled=0;enemiesToKill=enemiesToKillConstant+Math.floor(gameModel.currentLevel/5);gameModel.currentLevel!=gameModel.levelsUnlocked&&(enemiesToKill*=5);resetGame();save()}function changeState(n){setTimeout(function(){currentState=n;n==states.running&&($("#message-overlay").fadeOut(),playerShipContainer.visible=!0);n==states.paused&&($("#message-overlay").html("Game paused<br>Press start or click to continue"),$("#message-overlay").show());n==states.levelComplete&&(playerShipContainer.visible=!1,gameModel.currentLevel==gameModel.levelsUnlocked?(gameModel.levelsUnlocked++,$("#message-overlay").html("Level Complete!<br>Credit bonus: "+formatMoney(gameModel.currentLevel*100)+"<br>You've unlocked level "+gameModel.levelsUnlocked+". Press start or click to play"),addCredits(gameModel.currentLevel*100),changeLevel(gameModel.levelsUnlocked),ShootrUI.updateUpgrades()):($("#message-overlay").html("Level Complete<br>Credit bonus: "+formatMoney(gameModel.currentLevel*100)+"<br>Press start or click to play again"),addCredits(gameModel.currentLevel*100)),$("#message-overlay").fadeIn(600),resetGame());n==states.levelFailed&&(playerShipContainer.visible=!1,resetGame(),$("#message-overlay").html("You have failed to complete the level<br>Press start or click to try again"),$("#message-overlay").fadeIn(600))})}function resetGame(){var n;for(enemyShipContainer.removeChildren(),Bullets.enemyBullets.resetAll(),Bullets.playerBullets.resetAll(),EnemyShips.waves=[],enemiesKilled=0,enemiesToKill=enemiesToKillConstant+Math.floor(gameModel.currentLevel/2),EnemyShips.allDeadTimer=0,gameModel.currentLevel!=gameModel.levelsUnlocked&&(enemiesToKill*=5),PlayerShip.playerShip.currShield=PlayerShip.playerShip.maxShield,PlayerShip.playerShip.xLoc=canvasWidth/2,PlayerShip.playerShip.yLoc=canvasHeight-canvasHeight/6,PlayerShip.playerShip.inPlay=1,PlayerShip.allPlayersDead=0,PlayerShip.allDeadAllDeadTimer=0,n=0;n<Bullets.enemyBullets.maxEnemyBullets;n++)Bullets.enemyBullets.inPlay[n]=0;for(n=0;n<Bullets.playerBullets.maxPlayerBullets;n++)Bullets.playerBullets.inPlay[n]=0;for(n=0;n<EnemyShips.wavePatterns.length;n++)EnemyShips.wavePatterns[n].inUse=!1;$("#p1-shield-div").removeClass("destroyed");destroyedWarning=!1;PlayerShip.playerShip.sprite.visible=!0}function update(){requestAnimationFrame(update);var t=(new Date).getTime(),n=Math.min(100,Math.max(t-lastUpdate,0))/1e3;lastUpdate=t;tintFlashTime+=n;(tintOn&&tintFlashTime>=tintOnTime||tintFlashTime>=tintOffTime)&&(tintOn=!tintOn,tintFlashTime=0);player1Gamepad>-1&&typeof navigator.getGamepads!="undefined"&&navigator.getGamepads()[player1Gamepad]&&(playerOneAxes=navigator.getGamepads()[player1Gamepad].axes);Stars.stars.update(n);Stars.shipTrails.update(n);PlayerShip.cursor.update(n);currentState==states.running&&(PlayerShip.updatePlayerShip(n),Bullets.updatePlayerBullets(n),EnemyShips.update(n),Bullets.updateEnemyBullets(n));Bullets.blasts.updateBlasts(n);Ships.blasts.update(n);Bullets.explosionBits.update(n);Ships.explosionBits.update(n);Ships.fragments.update(n);renderer.render(stage);PlayerShip.drawShield(shield1Ctx);ShootrUI.updateFps(t)}function startGame(){load();canvas=document.getElementById("game_canvas");renderer=PIXI.autoDetectRenderer(canvasWidth,canvasHeight,{view:canvas,backgroundColor:0});stage=new PIXI.Container;stage.interactive=!0;stage.hitArea=new PIXI.Rectangle(0,0,canvasWidth,canvasHeight);stage.defaultCursor="crosshair";stage.tap=clickCanvas;stage.click=clickCanvas;stage.mousemove=function(n){aimLocX=n.data.getLocalPosition(stage).x;aimLocY=n.data.getLocalPosition(stage).y;(aimLocX<0||aimLocX>canvasWidth||aimLocY<0||aimLocY>canvasHeight)&&(aimLocX=0,aimLocY=0)};$("#message-overlay").off("click").on("click",function(){currentState!=states.running&&changeState(states.running)});starContainer=new PIXI.Container;bulletContainer=new PIXI.Container;enemyShipContainer=new PIXI.Container;playerShipContainer=new PIXI.Container;playerShipContainer.visible=!1;explosionContainer=new PIXI.Container;uiContainer=new PIXI.Container;stage.addChild(starContainer);stage.addChild(bulletContainer);stage.addChild(enemyShipContainer);stage.addChild(playerShipContainer);stage.addChild(explosionContainer);stage.addChild(uiContainer);shield1=document.getElementById("p1-shield");shield1Ctx=shield1.getContext("2d");shield1.width=100;shield1.height=25;Stars.stars.initialize();Stars.shipTrails.initialize();PlayerShip.initialize();PlayerShip.cursor.initialize();Bullets.playerBullets.initialize();Bullets.enemyBullets.initialize();Bullets.blasts.initialize();Ships.blasts.initialize();Bullets.explosionBits.initialize();Ships.fragments.initialize();Ships.explosionBits.initialize();resetGame();ShootrUI.updateGamepadSelect();update();ShootrUI.updateUI();ShootrUI.updateUpgrades();changeLevel(gameModel.currentLevel)}function clickCanvas(n){currentState==states.running?(clickLocX=n.data.getLocalPosition(stage).x,clickLocY=n.data.getLocalPosition(stage).y,aimLocX=0,aimLocY=0):changeState(states.running)}var canvas,canvasWidth=480,canvasHeight=640,debug=!1,playerTwo=!1,enemiesToKillConstant=20,enemiesKilled=0,enemiesToKill=0,w=!1,a=!1,s=!1,d=!1,states={running:0,paused:1,waitingToStart:2,levelComplete:3,levelFailed:4},currentState=2,shield1,shield1Ctx,ctx,canvasData,canvasDataArr,clickLocX,clickLocY,aimLocX,aimLocY,lastUpdate=0,playerOneAxes=[],playerTwoAxes=[],tintOnTime=.1,tintOffTime=.3,tintFlashTime=0,tintOn=!1,coords,stage,starContainer,bulletContainer,enemyShipContainer,playerShipContainer,explosionContainer,uiContainer,renderer;startGame();window.onkeydown=function(n){switch(n.keyCode){case 87:w=!0;break;case 65:a=!0;break;case 83:s=!0;break;case 68:d=!0;break;case 38:w=!0;break;case 37:a=!0;break;case 40:s=!0;break;case 39:d=!0;break;default:return!0}return!1};window.onkeyup=function(n){switch(n.keyCode){case 87:w=!1;break;case 65:a=!1;break;case 83:s=!1;break;case 68:d=!1;break;case 38:w=!1;break;case 37:a=!1;break;case 40:s=!1;break;case 39:d=!1;break;default:return!0}return!1};
//# sourceMappingURL=shootr.min.js.map
