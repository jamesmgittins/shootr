var EnemyShips={};EnemyShips.allDeadTimer=0;EnemyShips.maxShipsPerWave=16;EnemyShips.minShipsPerWave=4;EnemyShips.shipHealth=2;EnemyShips.maxWaves=3;EnemyShips.waveBulletFrequency=3e3;EnemyShips.explosionBits={bitsPerExplosion:24,maxExplosionBits:128,currentExplosionBit:0,opacity:[],xLoc:[],yLoc:[],color:[],xSpeed:[],ySpeed:[],vertical:[],newExplosionBit:function(n,t){EnemyShips.explosionBits.currentExplosionBit>=EnemyShips.explosionBits.maxExplosionBits&&(EnemyShips.explosionBits.currentExplosionBit=0);EnemyShips.explosionBits.opacity[EnemyShips.explosionBits.currentExplosionBit]=255;EnemyShips.explosionBits.xLoc[EnemyShips.explosionBits.currentExplosionBit]=n.xLoc;EnemyShips.explosionBits.yLoc[EnemyShips.explosionBits.currentExplosionBit]=n.yLoc;EnemyShips.explosionBits.color[EnemyShips.explosionBits.currentExplosionBit]=Math.random()>.8?{r:255,g:190,b:51}:t[Math.floor(Math.random()*t.length)];EnemyShips.explosionBits.xSpeed[EnemyShips.explosionBits.currentExplosionBit]=n.xSpeed/2-150+Math.random()*300;EnemyShips.explosionBits.ySpeed[EnemyShips.explosionBits.currentExplosionBit]=n.ySpeed/2-150+Math.random()*300;EnemyShips.explosionBits.vertical[EnemyShips.explosionBits.currentExplosionBit]=Math.random()>.5;EnemyShips.explosionBits.currentExplosionBit++}};EnemyShips.fragments=[];EnemyShips.fragmentsPerExplosion=6;EnemyShips.maxExplosionFragments=32;EnemyShips.currentExplosionFragment=0;EnemyShips.generateExplosion=function(n){for(var i,t=0;t<EnemyShips.explosionBits.bitsPerExplosion;t++)EnemyShips.explosionBits.newExplosionBit(n,n.wave.colorsRgb);for(i=EnemyShips.fragmentsPerExplosion+Math.random()*EnemyShips.fragmentsPerExplosion,t=0;t<i;t++)EnemyShips.currentExplosionFragment>=EnemyShips.maxExplosionFragments&&(EnemyShips.currentExplosionFragment=0),EnemyShips.fragments[EnemyShips.currentExplosionFragment]={opacity:1,xLoc:n.xLoc-5+Math.random()*10,yLoc:n.yLoc-5+Math.random()*10,bitmap:n.wave.shipFragments[Math.floor(Math.random()*n.wave.shipFragments.length)],xSpeed:n.xSpeed/2-50+Math.random()*100,ySpeed:n.ySpeed/2-50+Math.random()*100,rotation:Math.random()*3.14,rotationSpeed:-1+Math.random()*2},EnemyShips.fragments[EnemyShips.currentExplosionFragment].width=EnemyShips.fragments[EnemyShips.currentExplosionFragment].bitmap.width,EnemyShips.currentExplosionFragment++;Ships.currentBlast>Ships.maxBlasts&&(Ships.currentBlast=0);Ships.blasts[Ships.currentBlast]={opacity:1,xLoc:n.xLoc-32,yLoc:n.yLoc-32};Ships.currentBlast++};EnemyShips.lastWave=6e3;EnemyShips.waveFrequency=1e4;EnemyShips.wavePatterns=[{xCoords:[.9,.9,.1,.1,.9,.9,.1,.1,.9,.9,.1,.1,.9,.9,.1,.1,.9,.9],yCoords:[-.2,.1,.1,.2,.2,.3,.3,.4,.5,.6,.6,.7,.7,.8,.8,.9,.9,1.1]},{xCoords:[-.2,.1,.3,.5,.7,.9,.7,.5,.3,.1,-.2],yCoords:[.45,.45,.2,.1,.2,.5,.7,.9,.7,.55,.55]},{xCoords:[-.2,.8,.9],yCoords:[.2,.1,1.3]},{xCoords:[.9,.2,.1],yCoords:[-.2,.5,1.3]},{xCoords:[.5,.5,.1,.9,.2,.9,.2],yCoords:[-.2,.1,.3,.5,.7,.9,1.1]},{xCoords:[-.2,.15,.2,.7,.8,.75,.8,.75,.9],yCoords:[.9,.85,.1,.1,.3,.5,.7,.9,1.1]},{xCoords:[.9,.9,.9,.5,0],yCoords:[1.1,.9,.1,.1,1.2]}];EnemyShips.patternCounter=Math.floor(Math.random()*EnemyShips.wavePatterns.length);EnemyShips.waves=[];EnemyShips.wave=function(){var t,n;for(this.shipFrequency=1e3+Math.random()*1e3,this.lastShipSpawned=0;typeof this.wavePattern=="undefined";)EnemyShips.wavePatterns[EnemyShips.patternCounter].inUse?(EnemyShips.patternCounter++,EnemyShips.patternCounter>=EnemyShips.wavePatterns.length&&(EnemyShips.patternCounter=0)):(this.wavePattern=EnemyShips.wavePatterns[EnemyShips.patternCounter],this.wavePattern.inUse=!0);for(this.shipsInWave=EnemyShips.minShipsPerWave+Math.round(Math.random()*(EnemyShips.maxShipsPerWave-EnemyShips.minShipsPerWave)),this.shipsDestroyed=0,t=Math.round(32+Math.random()*32),this.colors=Ships.enemyColors[Math.floor(Math.random()*Ships.enemyColors.length)],this.colorsRgb=[],n=0;n<this.colors.length;n++)this.colorsRgb[n]=hexToRgb(this.colors[n]);this.shipHealth=EnemyShips.shipHealth;this.lastBullet=0;this.texture=PIXI.Texture.fromCanvas(Ships.shipArt(t,Date.now(),!0,this.colors));this.shipFragments=Ships.shipFragments(this.colors);this.maxSpeed=90+Math.random()*20;this.offset=Math.round(t/2);this.ships=[];this.shipsExited=0};EnemyShips.enemyShip=function(n){this.wave=n;this.SHIP_TRAIL_COUNT=Ships.shipTrailCount;this.xLoc=canvasWidth*n.wavePattern.xCoords[0];this.xTar=canvasWidth*n.wavePattern.xCoords[1];this.yLoc=canvasHeight*n.wavePattern.yCoords[0];this.yTar=canvasHeight*n.wavePattern.yCoords[1];this.nextCoord=1;this.maxSpeed=n.maxSpeed;this.health=n.shipHealth;this.inPlay=1;this.enemyShip=!0;this.rotation=0;this.offset=n.offset;this.sprite=new PIXI.Sprite(n.texture);this.sprite.position.x=this.xLoc;this.sprite.position.y=this.yLoc;this.sprite.anchor={x:.5,y:.5};enemyShipContainer.addChild(this.sprite)};EnemyShips.destroy=function(n){n.sprite.visible=!1;n.inPlay=0;n.wave.shipsDestroyed++;n.wave.shipsDestroyed>=n.wave.shipsInWave&&(addCredits(n.wave.shipHealth*n.wave.shipsInWave*.5),setTimeout(function(){$("#message-overlay-small").html("Wave destroyed<br>"+formatMoney(n.wave.shipHealth*n.wave.shipsInWave*.5)+" bonus credits!").show().delay(1500).fadeOut(1e3)}));enemiesKilled++;EnemyShips.generateExplosion(n);addCredits(n.wave.shipHealth);enemiesKilled>=enemiesToKill&&(EnemyShips.allDeadTimer=0)};EnemyShips.checkForPlayerCollision=function(n){Ships.detectShipCollision(n,PlayerShip.playerShip)&&(PlayerShip.damagePlayerShip(PlayerShip.playerShip,n.health),EnemyShips.destroy(n))};EnemyShips.checkForBulletCollisions=function(n){for(var t=0;t<Bullets.playerBullets.maxPlayerBullets;t++)Bullets.playerBullets.inPlay[t]===1&&Ships.detectCollision(n,Bullets.playerBullets.xLoc[t],Bullets.playerBullets.yLoc[t])&&(Bullets.playerBullets.inPlay[t]=0,Bullets.playerBullets.sprite[t].visible=!1,Bullets.generateExplosion(Bullets.playerBullets.xLoc[t],Bullets.playerBullets.yLoc[t]),n.health-=Bullets.playerBullets.strength,n.health<=0&&EnemyShips.destroy(n))};EnemyShips.update=function(n){var i,r,t,u,f;for(EnemyShips.lastWave+=n*1e3,enemiesKilled>=enemiesToKill&&(EnemyShips.allDeadTimer+=n*1e3,EnemyShips.allDeadTimer>PlayerShip.allDeadTime&&changeState(states.levelComplete)),i=0;i<EnemyShips.maxWaves;i++)if(!EnemyShips.waves[i]||EnemyShips.waves[i].finished)EnemyShips.lastWave>=EnemyShips.waveFrequency&&Math.random()>.9&&(EnemyShips.waves[i]=new EnemyShips.wave,EnemyShips.lastWave=0);else{for(EnemyShips.waves[i].lastShipSpawned+=n*1e3,EnemyShips.waves[i].lastBullet+=n*1e3,r=0;r<EnemyShips.waves[i].shipsInWave;r++)EnemyShips.waves[i].ships[r]?EnemyShips.waves[i].ships[r].inPlay&&(t=EnemyShips.waves[i].ships[r],enemiesKilled>=enemiesToKill&&(t.inPlay=0,t.xLoc>0&&t.yLoc>0&&EnemyShips.generateExplosion(t)),Math.sqrt(Math.pow(t.xLoc-t.xTar,2)+Math.pow(t.yLoc-t.yTar,2))>5?(u=t.xTar-t.xLoc,f=t.yTar-t.yLoc,Ships.updateShipSpeed(t,u,f,n),Ships.updateRotation(t,n),t.sprite.position.x=t.xLoc,t.sprite.position.y=t.yLoc,t.sprite.rotation=-t.rotation):(t.nextCoord++,t.nextCoord>=EnemyShips.waves[i].wavePattern.xCoords.length?(t.inPlay=0,t.sprite.visible=!1,EnemyShips.waves[i].shipsExited++):(t.xTar=canvasWidth*EnemyShips.waves[i].wavePattern.xCoords[t.nextCoord],t.yTar=canvasHeight*EnemyShips.waves[i].wavePattern.yCoords[t.nextCoord])),EnemyShips.checkForBulletCollisions(t),EnemyShips.checkForPlayerCollision(t),t.inPlay&&EnemyShips.waves[i].lastBullet>=EnemyShips.waveBulletFrequency&&Math.random()>.9&&(Bullets.enemyBullets.newEnemyBullet(t),EnemyShips.waves[i].lastBullet=0)):EnemyShips.waves[i].lastShipSpawned>=EnemyShips.waves[i].shipFrequency&&(EnemyShips.waves[i].ships[r]=new EnemyShips.enemyShip(EnemyShips.waves[i]),EnemyShips.waves[i].ships[r].shipTrail=new Stars.shipTrail(EnemyShips.waves[i].ships[r]),EnemyShips.waves[i].lastShipSpawned=0);EnemyShips.waves[i].shipsExited+EnemyShips.waves[i].shipsDestroyed>=EnemyShips.waves[i].shipsInWave&&(EnemyShips.waves[i].finished=!0,EnemyShips.waves[i].wavePattern.inUse=!1)}};EnemyShips.drawShipFragments=function(n,t){var i;if(EnemyShips.fragments.length>0)for(i=0;i<EnemyShips.fragments.length;i++)EnemyShips.fragments[i]&&EnemyShips.fragments[i].opacity>0&&(EnemyShips.fragments[i].rotation+=EnemyShips.fragments[i].rotationSpeed*t,EnemyShips.fragments[i].xLoc+=EnemyShips.fragments[i].xSpeed*t,EnemyShips.fragments[i].yLoc+=EnemyShips.fragments[i].ySpeed*t,n.save(),n.translate(EnemyShips.fragments[i].xLoc,EnemyShips.fragments[i].yLoc),n.rotate(EnemyShips.fragments[i].rotation),n.globalAlpha=EnemyShips.fragments[i].opacity,n.drawImage(EnemyShips.fragments[i].bitmap,-EnemyShips.fragments[i].width/2,0),n.restore(),EnemyShips.fragments[i].opacity-=.2*t/EnemyShips.fragments[i].opacity);if(Ships.blasts.length>0)for(i=0;i<Ships.blasts.length;i++)Ships.blasts[i]&&Ships.blasts[i].opacity>0&&(n.globalAlpha=Ships.blasts[i].opacity,n.drawImage(Ships.shipBlastArt,Ships.blasts[i].xLoc,Ships.blasts[i].yLoc),Ships.blasts[i].opacity-=6*t);for(i=0;i<Bullets.blasts.maxBlasts;i++)Bullets.blasts.opacity[i]&&Bullets.blasts.opacity[i]>0&&(n.globalAlpha=Bullets.blasts.opacity[i],n.drawImage(Bullets.blasts.art,Bullets.blasts.xLoc[i],Bullets.blasts.yLoc[i]),Bullets.blasts.opacity[i]-=6*t);n.globalAlpha=1};EnemyShips.drawShips=function(n){var t,i;if(EnemyShips.waves&&!(EnemyShips.waves.length<=0)&&EnemyShips.waves.length>0)for(t=0;t<EnemyShips.waves.length;t++)if(EnemyShips.waves[t]&&!EnemyShips.waves[t].finished&&EnemyShips.waves[t].shipsInWave)for(i=0;i<EnemyShips.waves[t].shipsInWave;i++)EnemyShips.waves[t].ships[i]&&EnemyShips.waves[t].ships[i].inPlay&&(n.save(),n.translate(EnemyShips.waves[t].ships[i].xLoc,EnemyShips.waves[t].ships[i].yLoc),n.rotate(-1*EnemyShips.waves[t].ships[i].rotation),n.drawImage(EnemyShips.waves[t].shipArt,-EnemyShips.waves[t].offset,-EnemyShips.waves[t].offset),n.restore())};
//# sourceMappingURL=enemyships.min.js.map
