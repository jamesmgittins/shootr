var EnemyShips={};EnemyShips.maxShipsPerWave=16;EnemyShips.minShipsPerWave=4;EnemyShips.shipHealth=2;EnemyShips.maxWaves=3;EnemyShips.waveBulletFrequency=3e3;EnemyShips.explosionBits=[];EnemyShips.bitsPerExplosion=24;EnemyShips.maxExplosionBits=256;EnemyShips.currentExplosionBit=0;EnemyShips.fragments=[];EnemyShips.fragmentsPerExplosion=8;EnemyShips.maxExplosionFragments=64;EnemyShips.currentExplosionFragment=0;EnemyShips.generateExplosion=function(n){for(var i,t=0;t<EnemyShips.bitsPerExplosion;t++)EnemyShips.currentExplosionBit>=EnemyShips.maxExplosionBits&&(EnemyShips.currentExplosionBit=0),EnemyShips.explosionBits[EnemyShips.currentExplosionBit]={opacity:255,xLoc:n.xLoc,yLoc:n.yLoc,color:Math.random()>.8?{r:255,g:190,b:51}:n.wave.colorsRgb[Math.floor(Math.random()*n.wave.colorsRgb.length)],xSpeed:n.xSpeed/2-150+Math.random()*300,ySpeed:n.ySpeed/2-150+Math.random()*300,vertical:Math.random()>.5},EnemyShips.currentExplosionBit++;for(i=EnemyShips.fragmentsPerExplosion+Math.random()*EnemyShips.fragmentsPerExplosion,t=0;t<i;t++)EnemyShips.currentExplosionFragment>=EnemyShips.maxExplosionFragments&&(EnemyShips.currentExplosionFragment=0),EnemyShips.fragments[EnemyShips.currentExplosionFragment]={opacity:1,xLoc:n.xLoc-5+Math.random()*10,yLoc:n.yLoc-5+Math.random()*10,bitmap:n.wave.shipFragments[Math.floor(Math.random()*n.wave.shipFragments.length)],xSpeed:n.xSpeed/2-50+Math.random()*100,ySpeed:n.ySpeed/2-50+Math.random()*100,rotation:Math.random()*3.14,rotationSpeed:-1+Math.random()*2},EnemyShips.fragments[EnemyShips.currentExplosionFragment].width=EnemyShips.fragments[EnemyShips.currentExplosionFragment].bitmap.width,EnemyShips.currentExplosionFragment++;Ships.currentBlast>Ships.maxBlasts&&(Ships.currentBlast=0);Ships.blasts[Ships.currentBlast]={opacity:1,xLoc:n.xLoc-32,yLoc:n.yLoc-32};Ships.currentBlast++};EnemyShips.lastWave=0;EnemyShips.waveFrequency=1e4;EnemyShips.wavePatterns=[{xCoords:[-.2,.8,.9],yCoords:[.2,.1,1.3]},{xCoords:[.9,.2,.1],yCoords:[-.2,.5,1.3]},{xCoords:[.5,.5,.1,.9,.2,.9,.2],yCoords:[-.2,.1,.3,.5,.7,.9,1.1]},{xCoords:[-.2,.15,.2,.7,.8,.75,.8,.75,.9],yCoords:[.9,.85,.1,.1,.3,.5,.7,.9,1.1]},{xCoords:[.9,.9,.9,.5,0],yCoords:[1.1,.9,.1,.1,1.2]}];EnemyShips.patternCounter=Math.floor(Math.random()*EnemyShips.wavePatterns.length);EnemyShips.waves=[];EnemyShips.wave=function(){var t,n;for(this.shipFrequency=1e3+Math.random()*1e3,this.lastShipSpawned=0;typeof this.wavePattern=="undefined";)EnemyShips.wavePatterns[EnemyShips.patternCounter].inUse?(EnemyShips.patternCounter++,EnemyShips.patternCounter>=EnemyShips.wavePatterns.length&&(EnemyShips.patternCounter=0)):(this.wavePattern=EnemyShips.wavePatterns[EnemyShips.patternCounter],this.wavePattern.inUse=!0);for(this.shipsInWave=EnemyShips.minShipsPerWave+Math.round(Math.random()*(EnemyShips.maxShipsPerWave-EnemyShips.minShipsPerWave)),this.shipsDestroyed=0,t=Math.round(32+Math.random()*32),this.colors=Ships.enemyColors[Math.floor(Math.random()*Ships.enemyColors.length)],this.colorsRgb=[],n=0;n<this.colors.length;n++)this.colorsRgb[n]=hexToRgb(this.colors[n]);this.shipHealth=EnemyShips.shipHealth;this.lastBullet=0;this.shipArt=Ships.shipArt(t,Date.now(),!0,this.colors);this.shipFragments=Ships.shipFragments(this.colors);this.offset=Math.round(t/2);this.ships=[];this.shipsExited=0};EnemyShips.enemyShip=function(n){this.wave=n;this.SHIP_TRAIL_COUNT=Ships.shipTrailCount;this.xLoc=canvasWidth*n.wavePattern.xCoords[0];this.xTar=canvasWidth*n.wavePattern.xCoords[1];this.yLoc=canvasHeight*n.wavePattern.yCoords[0];this.yTar=canvasHeight*n.wavePattern.yCoords[1];this.nextCoord=1;this.maxSpeed=100;this.health=n.shipHealth;this.inPlay=1;this.enemyShip=!0;this.shipTrail=[];this.rotation=0;this.offset=n.offset;for(var t=0;t<this.SHIP_TRAIL_COUNT;t++)this.shipTrail[t]=new Stars.shipTrailPart(this)};EnemyShips.checkForPlayerCollision=function(n){Ships.detectShipCollision(n,PlayerShip.playerShip)&&(n.health>PlayerShip.playerShip.health?(n.health-=PlayerShip.playerShip.health,PlayerShip.playerShip.health-=n.health):(n.inPlay=0,n.wave.shipsDestroyed++,EnemyShips.generateExplosion(n)))};EnemyShips.checkForBulletCollisions=function(n){for(var t=0;t<Bullets.playerBullets.maxPlayerBullets;t++)Bullets.playerBullets.inPlay[t]===1&&Ships.detectCollision(n,Bullets.playerBullets.xLoc[t],Bullets.playerBullets.yLoc[t])&&(Bullets.playerBullets.inPlay[t]=0,Bullets.generateExplosion(Bullets.playerBullets.xLoc[t],Bullets.playerBullets.yLoc[t]),n.health-=Bullets.playerBullets.strength,n.health<=0&&(n.inPlay=0,n.wave.shipsDestroyed++,EnemyShips.generateExplosion(n),credits+=n.wave.shipHealth))};EnemyShips.update=function(n){var t,r,i,u,f;for(EnemyShips.lastWave+=n*1e3,t=0;t<EnemyShips.maxWaves;t++)if(!EnemyShips.waves[t]||EnemyShips.waves[t].finished)EnemyShips.lastWave>=EnemyShips.waveFrequency&&Math.random()>.9&&(EnemyShips.waves[t]=new EnemyShips.wave,EnemyShips.lastWave=0);else{for(EnemyShips.waves[t].lastShipSpawned+=n*1e3,EnemyShips.waves[t].lastBullet+=n*1e3,r=0;r<EnemyShips.waves[t].shipsInWave;r++)EnemyShips.waves[t].ships[r]?EnemyShips.waves[t].ships[r].inPlay&&(i=EnemyShips.waves[t].ships[r],Math.sqrt(Math.pow(i.xLoc-i.xTar,2)+Math.pow(i.yLoc-i.yTar,2))>5?(u=i.xTar-i.xLoc,f=i.yTar-i.yLoc,Ships.updateShipSpeed(i,u,f,n),Ships.updateRotation(i,n)):(i.nextCoord++,i.nextCoord>=EnemyShips.waves[t].wavePattern.xCoords.length?(i.inPlay=0,EnemyShips.waves[t].shipsExited++):(i.xTar=canvasWidth*EnemyShips.waves[t].wavePattern.xCoords[i.nextCoord],i.yTar=canvasHeight*EnemyShips.waves[t].wavePattern.yCoords[i.nextCoord])),EnemyShips.checkForBulletCollisions(i),EnemyShips.checkForPlayerCollision(i),i.inPlay&&EnemyShips.waves[t].lastBullet>=EnemyShips.waveBulletFrequency&&Math.random()>.9&&(Bullets.newEnemyBullet(i),EnemyShips.waves[t].lastBullet=0)):EnemyShips.waves[t].lastShipSpawned>=EnemyShips.waves[t].shipFrequency&&(EnemyShips.waves[t].ships[r]=new EnemyShips.enemyShip(EnemyShips.waves[t]),EnemyShips.waves[t].lastShipSpawned=0);EnemyShips.waves[t].shipsExited+EnemyShips.waves[t].shipsDestroyed>=EnemyShips.waves[t].shipsInWave&&(EnemyShips.waves[t].finished=!0,EnemyShips.waves[t].wavePattern.inUse=!1)}};EnemyShips.drawShipFragments=function(n,t){var i;if(EnemyShips.fragments.length>0)for(i=0;i<EnemyShips.fragments.length;i++)EnemyShips.fragments[i]&&EnemyShips.fragments[i].opacity>0&&(EnemyShips.fragments[i].rotation+=EnemyShips.fragments[i].rotationSpeed*t,EnemyShips.fragments[i].xLoc+=EnemyShips.fragments[i].xSpeed*t,EnemyShips.fragments[i].yLoc+=EnemyShips.fragments[i].ySpeed*t,n.save(),n.translate(EnemyShips.fragments[i].xLoc,EnemyShips.fragments[i].yLoc),n.rotate(EnemyShips.fragments[i].rotation),n.globalAlpha=EnemyShips.fragments[i].opacity,n.drawImage(EnemyShips.fragments[i].bitmap,-EnemyShips.fragments[i].width/2,0),n.restore(),EnemyShips.fragments[i].opacity-=.2*t/EnemyShips.fragments[i].opacity);if(Ships.blasts.length>0)for(i=0;i<Ships.blasts.length;i++)Ships.blasts[i]&&Ships.blasts[i].opacity>0&&(n.globalAlpha=Ships.blasts[i].opacity,n.drawImage(Ships.shipBlastArt,Ships.blasts[i].xLoc,Ships.blasts[i].yLoc),Ships.blasts[i].opacity-=6*t);for(i=0;i<Bullets.blasts.maxBlasts;i++)Bullets.blasts.opacity[i]&&Bullets.blasts.opacity[i]>0&&(n.globalAlpha=Bullets.blasts.opacity[i],n.drawImage(Bullets.blasts.art,Bullets.blasts.xLoc[i],Bullets.blasts.yLoc[i]),Bullets.blasts.opacity[i]-=6*t);n.globalAlpha=1};EnemyShips.drawShips=function(n){var t,i;if(EnemyShips.waves&&!(EnemyShips.waves.length<=0)&&EnemyShips.waves.length>0)for(t=0;t<EnemyShips.waves.length;t++)if(EnemyShips.waves[t]&&EnemyShips.waves[t].shipsInWave)for(i=0;i<EnemyShips.waves[t].shipsInWave;i++)EnemyShips.waves[t].ships[i]&&EnemyShips.waves[t].ships[i].inPlay&&(n.save(),n.translate(EnemyShips.waves[t].ships[i].xLoc,EnemyShips.waves[t].ships[i].yLoc),n.rotate(-1*EnemyShips.waves[t].ships[i].rotation),n.drawImage(EnemyShips.waves[t].shipArt,-EnemyShips.waves[t].offset,-EnemyShips.waves[t].offset),n.restore())};
//# sourceMappingURL=enemyships.min.js.map
